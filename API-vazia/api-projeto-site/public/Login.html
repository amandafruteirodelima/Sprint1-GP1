<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="./css/Login.css">
    <link rel="stylesheet" href="./css/headerLight2.css">
    <link rel="icon" href="img/Yin-Yang-DevTime.png">

    <title>Login</title>
</head>

<body>
    <!--Início Header-->

    <div class="divHeader">

        <div class="container-header">

            <div class="divImagem"><img src="./img/Logo-Branco.png" alt="Logo DevTime"></div>

            <nav class="divLista">
                <ul>
                    <li><a class="li-comum" href="index.html">Home</a></li>
                    <li><a class="li-comum" href="sobrepage.html">Sobre</a></li>
                    <li><a class="li-comum" href="contato.html">Contato</a></li>
                </ul>

            </nav>

            <div class="divButtonHeader"><button><a class="li-select" href="Login.html">Entrar</a></button></div>

        </div>

    </div>
    <!--Fim Header-->


    <div class="content">
        <div class="login-cor">
            <div class="txt-titulo">// Com organização e tempo, acha-se o segredo de se fazer tudo e bem feito.</div>
            <img class="img_login_2" src="./img/imagem-1.png" alt="">
        </div>

        <div class="conteudo-login">

            <img class="img_login" src="./img/Login-gradiente.png" alt="">

            <div class="div-inpts">


                <form id="form_login" method="post" onsubmit="return entrar()">

                    <input class="inptLarge inptPadrao" type="email" name="email" placeholder=" " required>
                    <label class="label-email" for="email">Email</label>
                    

                    <input class="inptLarge inptPadrao" type="password" name="senha" placeholder=" " required>
                    <label style="font-family: 'Poppins-Bold'; font-size: small;" class="label-senha"
                    for="senha">Senha</label>
                    
                    

                    <button class="btn-default"><a class="link-comum"><b>Entrar</b></a></button>
                </form>

            </div>
        </div>
    </div>

</body>

</html>

<script>


function entrar() {
        
        var formulario = new URLSearchParams(new FormData(form_login));
        fetch("/usuarios/autenticar", {
            method: "POST",
            body: formulario
        }).then(resposta => {

            if (resposta.ok) {

                resposta.json().then(json => {

                    

                    alert("Login realizado com sucesso!")
                    console.log(json);

                    if(json.idFuncionario){
                        sessionStorage.login_usuario_meuapp = json.email;
                    sessionStorage.nome_usuario_meuapp = json.nome;
                        window.location.href = 'Perfil_usuario.html';
                    }
                    else{
                        sessionStorage.login_usuario_meuapp = json.emailGestor;
                        sessionStorage.nome_usuario_meuapp = json.nomeGestor;
                        window.location.href = 'Dashboard_adm.html';
                    }
                });

            } else {

                console.log('Erro de login!');

                resposta.text().then(texto => {
                    console.error(texto);
                    finalizar_aguardar(texto);
                });
            }
        });

        return false;
    }

</script>